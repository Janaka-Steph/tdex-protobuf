syntax = "proto3";
option go_package = "github.com/tdex-network/tdex-protobuf/generated/go/handshake";

// BOTD#1
message SecretMessage {
  uint32 lenght = 1;
  bytes payload = 2;
}
// BOTD#2
message Init {
  // Random unique identifier for the current message
  string id = 1;
  // Secp256k1 Sender's public key
  bytes sender_pubkey = 2;
  // Secp256k1 Recipient's public key
  bytes recipient_pubkey = 3;
  // Ephemeral public key generated by the sender
  bytes ephemeral_pubkey = 4;
  // secp256k1 signature of
  // sha256(sender_pubkey,recipient_pubkey,sender_ephemeral_pubkey)
  bytes signature = 5;
}

message Ack {
  // Random unique identifier for the current message
  string id = 1;
  // indetifier of the Init message
  string init_id = 2;
  // Ephemeral public key generated by the recipient
  bytes ephemeral_pubkey = 3;
  // secp256k1 signature of
  // sha256(recipient_pubkey,sender_pubkey,recipient_ephemeral_pubkey)
  bytes signature = 4;
}
